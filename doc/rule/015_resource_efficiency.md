# 资源效率控制

**原则ID**: PR-015
**来源文档**: agent_event_handling_mechanism.md
**类别**: 资源管理

---

## 原则描述

通过控制轮询间隔和休眠机制，优化Agent的资源消耗。

## 资源控制策略

### 1. 动态轮询间隔

根据Agent的状态调整扫描频率：

- **运行中**: 默认扫描间隔（如10秒）
- **繁忙时**: 缩短扫描间隔（如5秒）
- **空闲时**: 延长扫描间隔（如30秒）
- **休眠**: 停止扫描，仅监听唤醒信号

### 2. 休眠机制

当Agent长期空闲时进入休眠模式：

**触发条件**:
- 连续空闲时间超过配置的阈值（默认30分钟）
- 没有待处理事件
- 没有活跃的任务

**休眠状态**:
- 停止轮询，不扫描inbox
- 停止心跳引擎
- 仅保留wakeup_listener运行
- 最小化资源占用

**唤醒条件**:
- 收到WAKEUP_SIGNAL
- inbox中有新文件到达
- 定时器触发

### 3. 快速唤醒

支持被唤醒信号立即激活：

- wakeup_listener监听唤醒信号
- 收到信号后立即恢复轮询
- 处理积压的事件
- 无需手动干预

## 资源状态

### 运行中

- **资源占用**: 正常
- **心跳**: 运行
- **响应时间**: <10秒

### 空闲

- **资源占用**: 低
- **心跳**: 运行（低频率）
- **响应时间**: <30秒

### 休眠

- **资源占用**: 最小化
- **心跳**: 停止
- **响应时间**: 立即响应唤醒信号

## 关键要点

- **按需分配**: 根据工作负载分配资源
- **自动休眠**: 空闲时自动进入休眠
- **快速唤醒**: 需要时立即激活
- **资源优化**: 最小化不必要的资源消耗

---

**最后更新**: 2025-01-08
